# wqs二分 & 带权二分 & cdq分治(三位偏序)

###### Write By 云岁月书 -- 2020-11-29 <-> 2020-11

## 一般应用：
>
    给了一个选物品的限制条件，要求刚好选m个，让你最大化（最小化）权值，

    然后其特点就是当选的物品越多的时候权值越大（越小）。

## 详细解法：

一般情况下，这种题目(带权二分)可可以很轻松地写出时间复杂度 $\Omicron(nk)$ 及以上的的动态规划。

若是没有选择数量限制的话，这种问题一般也有 $\Omicron(n)$ 的解法。

另外一点就是，当我们以选择的数量限制为自变量，构造一个关于答案的函数时，这个函数必须是凸函数。

如图便是一个下凸函数：

![shangtu](/shangtu.png)

在此时wqs二分便派上了用场，我们可以不设选择段数的限制，反而给每选一段添加额外的代价。

这是相当于给原来的函数加上了一个一次函数，易知此时函数仍然是凸函数。

如图，每一段附上一定代价后，就可以得到蓝色的函数。

![shangtu-2](/shangtu-2.png)

感性的证明一下，就是每次增大选段的代价 $(mid)$，就会往上拉原函数，减小选段代价，就会往下拽原函数，通过这种操作，我们可以让原题目要求选的段数 $(K)$ 正好成为函数的极值点，此时答案就是 $ans - K*mid$，需要注意的就是一定是 $K*mid$ 而不能是 $mid*g[n]$ ($g[n]$ 即到第 $n$ 个截取了几段)。

所以其实 wqs 还是挺套路的一个板子，但是它在实际应用却有很多小问题，比如二分的边界问题。

另外它本身一般都是和各种毒瘤 DP 结合在一起做的。

这里给几道题: